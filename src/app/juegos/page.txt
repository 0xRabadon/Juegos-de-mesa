"use client";

import React, { useEffect, useState } from "react";
import Image from "next/image";
//import styles from "./page.module.css";
//import CajaComentario from './components/CajaComentarios';

export default function Page() {
  // API data
  const [juegos, setJuegos] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError]   = useState(null);


  useEffect(() => {
    (async () => {
      try {
        const res = await fetch("/api/juegos", { cache: "no-store" });
        const json = await res.json();
        if (!res.ok) throw new Error(json?.message || "Error fetching juegos");
        setJuegos(Array.isArray(json.data) ? json.data : []);
      } catch (e) {
        setError(e.message ?? "Unknown error");
      } finally {
        setLoading(false);
      }
    })();
  }, []);

  const totalPaginas = Math.ceil(juegos.length / itemsPorPagina) || 1;
  const indiceInicial = (paginaActual - 1) * itemsPorPagina;
  const juegosActuales = juegos.slice(indiceInicial, indiceInicial + itemsPorPagina);

  if (loading) {
    return (
      <main className={styles.container}>
        <h1 className={styles.pageHeader}>Cargando juegos…</h1>
      </main>
    );
  }

  if (error) {
    return (
      <main className={styles.container}>
        <h1 className={styles.pageHeader}>Error</h1>
        <p>No se pudieron cargar los juegos: {error}</p>
      </main>
    );
  }

  return (
    <>
      {/* Barra de navegacion */}
      <nav className={styles.navbar}>
        <div className={styles.navbarContainer}>
          <a href="#" className={styles.logo}>Juegos de Mesa</a>
          <ul className={styles.navLinks}>
            <li><a href="#">Inicio</a></li>
            <li><a href="#">Catálogo</a></li>
            <li><a href="#">Contacto</a></li>
          </ul>
        </div>
      </nav>
    </>
  );
}